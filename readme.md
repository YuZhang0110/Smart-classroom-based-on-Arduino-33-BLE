# Chair Occupancy Detection
Our project consists of two primary parts: a chair and an Android application.

# Part 1: The Chair
The chair is firmly attached to an Arduino Nano 33 BLE, which tracks the chair's occupancy via an AI-enhanced program that has learned and been tested on our sitting habits.

# Bluetooth and Arduino
For this project, we used the Arduino 33 BLE because it includes a Bluetooth module and an accelerometer. Both make it easier to write programs due to fewer external variables and potential problems.

We initialized the Arduino's Bluetooth connection using the predefined ArduinoBLE library, and we utilized parts of example Bluetooth programs to get us started.

We had to register a new BLE service through which data is sent and received in the form of "1" or "0" strings, indicating whether the chair is occupied or not.

After setting the local name, we only sent the battery status and checked if Arduino is connected to the phone to test the BLE connection. Luckily it worked, so we moved on to the next part of the project, the machine learning algorithm.

# Part 2: Machine Learning Details
For occupancy detection, we implemented edge machine learning analysis of specific vibration patterns generated when a user sits down or stands up. This was accomplished using the Edge Impulse library. To provide a good dataset for training the neural network, we recorded about five minutes of labeled records and testing/validation data.

Before neural analysis, the data was segmented into two-second chunks and parameterized using spectral analysis. This produced a vector containing 207 features, which was then passed to an input layer with 207 neurons. Using three hidden layers with 96, 56, and 30 neurons respectively, and finally an output layer with three neurons representing three classification labels: Sitting, Standing, and Idle. The accuracy reached 93% on our labeled test data.

The classification model was then exported as an Arduino library and integrated with our device firmware, which analyzes the labels generated by the neural network.

First, we downloaded the .zip library from the Edge Impulse website and opened an example program named "nano_33ble_sense_accelerometer_continuous". The program continuously tracks the chair's occupancy and transmits the status every second via a serial connection. We tested the program's accuracy in real-life application and were satisfied with the results as it always detected the correct conditions.

# Part 3: Android Application
To receive and display the data, we used an Android application developed with MIT App Inventor. It's a useful tool for rapid prototyping and developing fairly complex applications.

The application has three main screens and functionalities:

On the main screen, you connect to the Arduino's BT module and can display the chair's occupancy data. At the top, you can choose which library to check occupancy for (right now you only select the library and nothing really happens, because we haven't implemented a global database or server where you can save the data to). You access the other two screens via two buttons on the home page.
Each page has its own scratch code, but for a glimpse, here's some code from the main screen. In the end, you can also find the MIT App Inventor files where you can further explore the code details.

And determine the occupancy status: idle or occupied. To provide direct visual feedback, an RGB LED is controlled to reflect the occupancy status - green for idle, red for occupied.